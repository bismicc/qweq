<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REGICIDE+ Card Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 30px;
            line-height: 1.6;
        }

        .game-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        h3 {
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .story {
            border: 1px solid #ccc;
            padding: 20px;
            margin-bottom: 30px;
        }

        .game-board {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .left-panel, .right-panel, .center-area {
            padding: 0;
        }

        .center-area {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .boss-area {
            border: 2px solid #000;
            padding: 25px;
            text-align: center;
        }

        .boss-card {
            border: 2px solid #000;
            padding: 20px;
            display: inline-block;
            min-width: 150px;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .boss-stats {
            margin-top: 15px;
            font-size: 1.1em;
        }

        .hand-area {
            border: 1px solid #ccc;
            padding: 25px;
            min-height: 200px;
        }

        .hand-title {
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .hand {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .card {
            border: 2px solid #000;
            padding: 15px 10px;
            min-width: 80px;
            text-align: center;
            cursor: pointer;
            user-select: none;
        }

        .card:hover {
            background: #f0f0f0;
        }

        .card.selected {
            background: #e0e0e0;
            border: 3px solid #000;
        }

        .card-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .card-suit {
            font-size: 1.8em;
        }

        .info-box {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 25px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
        }

        .shop-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .shop-item {
            border: 1px solid #ccc;
            padding: 15px;
            cursor: pointer;
        }

        .shop-item:hover {
            background: #f5f5f5;
        }

        .button {
            border: 1px solid #000;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
            background: #fff;
        }

        .button:hover {
            background: #f0f0f0;
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button.attack-btn {
            background: #e74c3c;
            color: white;
            border: 2px solid #c0392b;
            font-weight: bold;
        }

        .button.attack-btn:hover:not(:disabled) {
            background: #c0392b;
        }

        .button.discard-btn {
            background: #f39c12;
            color: white;
            border: 2px solid #e67e22;
            font-weight: bold;
        }

        .button.discard-btn:hover:not(:disabled) {
            background: #e67e22;
        }

        .button.joker-btn {
            background: #9b59b6;
            color: white;
            border: 2px solid #8e44ad;
        }

        .button.joker-btn:hover:not(:disabled) {
            background: #8e44ad;
        }

        .button.skip-btn {
            background: #3498db;
            color: white;
            border: 2px solid #2980b9;
        }

        .button.skip-btn:hover:not(:disabled) {
            background: #2980b9;
        }

        .button.reset-btn {
            background: #95a5a6;
            color: white;
            border: 2px solid #7f8c8d;
        }

        .button.reset-btn:hover {
            background: #7f8c8d;
        }

        .actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .message {
            border: 1px solid #000;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .discard-pile {
            border: 1px solid #ccc;
            padding: 15px;
            max-height: 150px;
            overflow-y: auto;
        }

        .game-over {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 3px solid #000;
            background: #fff;
            padding: 40px;
            text-align: center;
            z-index: 1000;
            min-width: 400px;
        }

        .game-over h2 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        @media (max-width: 1200px) {
            .game-board {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>REGICIDE+</h1>
        </div>

        <div class="story">
            The people of the village have lost their homes, money, and family because of the corrupt leaders. Your goal is to face those leaders and bring back peace to your community using your party that consists of heroes, animal companions, and items with special abilities.
        </div>

        <div class="game-board">
            <div class="left-panel">
                <h3>Resources</h3>
                <div class="info-box">
                    <div class="info-row">
                        <span>Money:</span>
                        <span id="money">0</span>
                    </div>
                    <div class="info-row">
                        <span>Hand Size:</span>
                        <span id="handSize">6</span>
                    </div>
                    <div class="info-row">
                        <span>Tavern Deck:</span>
                        <span id="tavernCount">0</span>
                    </div>
                </div>

                <h3>Shop</h3>
                <div class="shop-items">
                    <div class="shop-item" onclick="buyHandSize()">
                        <div>Increase Hand Size</div>
                        <div style="font-size: 0.9em; color: #f39c12;">Cost: 2000</div>
                    </div>
                    <div class="shop-item" onclick="buyJoker()">
                        <div>Buy Joker</div>
                        <div style="font-size: 0.9em; color: #f39c12;">Cost: 1500</div>
                    </div>
                </div>
            </div>

            <div class="center-area">
                <div class="boss-area">
                    <h2>üëë Current Boss</h2>
                    <div id="bossCard"></div>
                    <div class="boss-stats" id="bossStats"></div>
                </div>

                <div id="messageArea"></div>

                <div class="hand-area">
                    <div class="hand-title">Your Hand (Click to select cards)</div>
                    <div class="hand" id="hand"></div>
                </div>

                <div class="actions">
                    <button class="button attack-btn" onclick="playCards()" id="attackBtn">‚öîÔ∏è Attack</button>
                    <button class="button joker-btn" onclick="useJoker()" id="jokerBtn" disabled>üÉè Use Joker (0)</button>
                    <button class="button skip-btn" onclick="endTurn()" id="skipBtn">Skip Turn</button>
                    <button class="button reset-btn" onclick="resetGame()">New Game</button>
                </div>
            </div>

            <div class="right-panel">
                <h3>Defeated Bosses</h3>
                <div id="defeatedBosses" class="discard-pile"></div>

                <h3 style="margin-top: 20px;">Discard Pile</h3>
                <div id="discardPile" class="discard-pile"></div>

                <h3 style="margin-top: 20px;">Rules</h3>
                <div style="font-size: 0.85em; line-height: 1.6;">
                    <div><strong>Suit Powers:</strong></div>
                    <div>‚ô†Ô∏è Spades: Reduce boss AP</div>
                    <div>‚ô•Ô∏è Hearts: Return cards to tavern</div>
                    <div>‚ô£Ô∏è Clubs: Double damage</div>
                    <div>‚ô¶Ô∏è Diamonds: Draw cards first</div>
                    <br>
                    <div><strong>Play Rules:</strong></div>
                    <div>‚Ä¢ Pairs/3-of-a-kind/4-of-a-kind</div>
                    <div>‚Ä¢ Aces can combo with any card</div>
                    <div>‚Ä¢ Boss immune to same suit</div>
                    <div>‚Ä¢ Face cards: J=10AP, Q=15AP, K=20AP</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SUITS = {
            SPADES: '‚ô†Ô∏è',
            HEARTS: '‚ô•Ô∏è',
            CLUBS: '‚ô£Ô∏è',
            DIAMONDS: '‚ô¶Ô∏è'
        };

        const SUIT_NAMES = ['spades', 'hearts', 'clubs', 'diamonds'];
        const VALUES = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10'];
        const FACE_CARDS = {
            'J': { hp: 20, ap: 10 },
            'Q': { hp: 30, ap: 15 },
            'K': { hp: 40, ap: 20 }
        };

        let gameState = {
            hand: [],
            tavernDeck: [],
            castleDeck: [],
            discardPile: [],
            defeatedBosses: [],
            currentBoss: null,
            money: 0,
            maxHandSize: 6,
            selectedCards: [],
            jokers: 0,
            aces: [],
            waitingForDiscard: false,
            discardRequired: 0
        };

        function initGame() {
            gameState = {
                hand: [],
                tavernDeck: [],
                castleDeck: [],
                discardPile: [],
                defeatedBosses: [],
                currentBoss: null,
                money: 0,
                maxHandSize: 6,
                selectedCards: [],
                jokers: 0,
                aces: [],
                waitingForDiscard: false,
                discardRequired: 0
            };

            createDecks();
            drawInitialHand();
            flipNextBoss();
            updateUI();
        }

        function createDecks() {
            // Create tavern deck (number cards and Aces)
            for (let suit of SUIT_NAMES) {
                for (let value of VALUES) {
                    gameState.tavernDeck.push({ value, suit });
                }
            }
            shuffle(gameState.tavernDeck);

            // Create castle deck (face cards)
            for (let suit of SUIT_NAMES) {
                for (let face of ['J', 'Q', 'K']) {
                    gameState.castleDeck.push({
                        value: face,
                        suit,
                        hp: FACE_CARDS[face].hp,
                        maxHp: FACE_CARDS[face].hp,
                        ap: FACE_CARDS[face].ap
                    });
                }
            }
            // Kings first, then Queens, then Jacks
            gameState.castleDeck.sort((a, b) => {
                const order = { 'K': 3, 'Q': 2, 'J': 1 };
                return order[b.value] - order[a.value];
            });
        }

        function shuffle(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function drawInitialHand() {
            for (let i = 0; i < gameState.maxHandSize; i++) {
                drawCard();
            }
        }

        function drawCard() {
            if (gameState.tavernDeck.length === 0) {
                showMessage('Tavern deck is empty! You cannot draw more cards.', 'error');
                gameLost();
                return false;
            }
            if (gameState.hand.length < gameState.maxHandSize) {
                gameState.hand.push(gameState.tavernDeck.pop());
                return true;
            }
            return false;
        }

        function flipNextBoss() {
            if (gameState.castleDeck.length === 0) {
                gameWon();
                return;
            }
            gameState.currentBoss = gameState.castleDeck.pop();
        }

        function playCards() {
            // If waiting for discard, process discard instead
            if (gameState.waitingForDiscard) {
                confirmDiscard();
                return;
            }

            if (gameState.selectedCards.length === 0) {
                showMessage('Select at least one card to play!', 'error');
                return;
            }

            if (!gameState.currentBoss) {
                showMessage('No boss to fight!', 'error');
                return;
            }

            const cards = gameState.selectedCards.map(idx => gameState.hand[idx]);
            
            // Check if cards can be played together
            if (!canPlayTogether(cards)) {
                showMessage('Cards must be same value or include an Ace with total ‚â§ 10!', 'error');
                return;
            }

            // Calculate total damage
            let totalDamage = 0;
            let suits = [];
            
            for (let card of cards) {
                const value = getCardValue(card);
                totalDamage += value;
                if (!suits.includes(card.suit)) {
                    suits.push(card.suit);
                }
            }

            // Apply suit powers BEFORE damage
            let bossAP = gameState.currentBoss.ap;
            let damageMultiplier = 1;
            let drawCards = 0;
            let returnCards = 0;
            let messages = [];

            for (let suit of suits) {
                // Check immunity - same suit as boss cancels suit power
                if (suit === gameState.currentBoss.suit) {
                    messages.push(`Boss is immune to ${SUITS[suit.toUpperCase()]}! Suit power canceled.`);
                    continue;
                }

                if (suit === 'spades') {
                    bossAP = Math.max(0, bossAP - totalDamage);
                    messages.push(`‚ô†Ô∏è Reduced boss AP by ${totalDamage}!`);
                }
                if (suit === 'clubs') {
                    damageMultiplier = 2;
                    messages.push(`‚ô£Ô∏è Damage doubled!`);
                }
                if (suit === 'diamonds') {
                    for (let card of cards) {
                        if (card.suit === 'diamonds') {
                            drawCards += getCardValue(card);
                        }
                    }
                    messages.push(`‚ô¶Ô∏è Will draw ${drawCards} cards!`);
                }
                if (suit === 'hearts') {
                    for (let card of cards) {
                        if (card.suit === 'hearts') {
                            returnCards += getCardValue(card);
                        }
                    }
                    messages.push(`‚ô•Ô∏è Will return ${returnCards} cards to tavern!`);
                }
            }

            // Apply diamonds power BEFORE boss attack
            if (drawCards > 0) {
                const cardsDrawn = Math.min(drawCards, gameState.maxHandSize - gameState.hand.length);
                for (let i = 0; i < cardsDrawn; i++) {
                    if (!drawCard()) break;
                }
                showMessage(`‚ô¶Ô∏è Drew ${cardsDrawn} cards first!`, 'success');
            }

            const finalDamage = totalDamage * damageMultiplier;
            gameState.currentBoss.hp -= finalDamage;

            showMessage(messages.join(' ') + ` | Dealt ${finalDamage} damage! Boss HP: ${Math.max(0, gameState.currentBoss.hp)}`, 'success');

            // Move played cards to discard
            gameState.selectedCards.sort((a, b) => b - a);
            for (let idx of gameState.selectedCards) {
                gameState.discardPile.push(gameState.hand.splice(idx, 1)[0]);
            }
            gameState.selectedCards = [];

            // Apply hearts power
            if (returnCards > 0) {
                const cardsToReturn = gameState.discardPile.splice(0, Math.min(returnCards, gameState.discardPile.length));
                shuffle(cardsToReturn);
                gameState.tavernDeck = [...cardsToReturn, ...gameState.tavernDeck];
            }

            // Check if boss is defeated
            if (gameState.currentBoss.hp <= 0) {
                bossDefeated();
            } else {
                // Boss attacks back
                bossAttack(bossAP);
            }

            updateUI();
        }

        function canPlayTogether(cards) {
            if (cards.length === 1) return true;

            const firstValue = cards[0].value;
            
            // Check if all same value (pairs, three of a kind, four of a kind)
            if (cards.every(c => c.value === firstValue)) return true;

            // Check if playing with Aces - Aces can be played with any card up to total 10
            const hasAce = cards.some(c => c.value === 'A');
            if (hasAce) {
                const total = cards.reduce((sum, card) => sum + getCardValue(card), 0);
                return total <= 10;
            }

            return false;
        }

        function getCardValue(card) {
            if (card.value === 'A') return 1;
            if (card.value === 'J') return 10;
            if (card.value === 'Q') return 15;
            if (card.value === 'K') return 20;
            return parseInt(card.value);
        }

        function bossAttack(ap) {
            if (ap === 0) {
                showMessage('Boss attack reduced to 0!', 'success');
                return;
            }

            gameState.discardRequired = ap;
            gameState.waitingForDiscard = true;
            gameState.selectedCards = [];
            
            showMessage(`Boss attacks for ${ap} AP! Select cards to discard (total value must be ‚â• ${ap})`, 'error');
            updateUI();
        }

        function confirmDiscard() {
            if (gameState.selectedCards.length === 0) {
                showMessage('Select cards to discard!', 'error');
                return;
            }

            const cards = gameState.selectedCards.map(idx => gameState.hand[idx]);
            const total = cards.reduce((sum, card) => sum + getCardValue(card), 0);

            if (total < gameState.discardRequired) {
                showMessage(`Need at least ${gameState.discardRequired} total value! Currently selected: ${total}`, 'error');
                return;
            }

            // Discard selected cards
            gameState.selectedCards.sort((a, b) => b - a);
            for (let idx of gameState.selectedCards) {
                gameState.discardPile.push(gameState.hand.splice(idx, 1)[0]);
            }

            showMessage(`Discarded ${cards.length} cards worth ${total} value!`, 'success');
            
            gameState.selectedCards = [];
            gameState.waitingForDiscard = false;
            gameState.discardRequired = 0;
            
            updateUI();
        }

        function canSurviveBossAttack(ap) {
            const hand = gameState.hand;
            const totalValue = hand.reduce((sum, card) => sum + getCardValue(card), 0);
            return totalValue >= ap;
        }

        function bossDefeated() {
            const reward = 1000 + Math.floor(gameState.hand.length / 2) * 100;
            gameState.money += reward;
            
            showMessage(`Boss defeated! Earned ${reward} gold!`, 'success');
            
            gameState.defeatedBosses.push(gameState.currentBoss);
            gameState.currentBoss = null;
            
            flipNextBoss();
        }

        function buyHandSize() {
            if (gameState.money >= 2000 && gameState.maxHandSize < 12) {
                gameState.money -= 2000;
                gameState.maxHandSize++;
                showMessage('Hand size increased!', 'success');
                updateUI();
            } else if (gameState.maxHandSize >= 12) {
                showMessage('Maximum hand size reached!', 'error');
            } else {
                showMessage('Not enough money!', 'error');
            }
        }

        function buyJoker() {
            if (gameState.money >= 1500) {
                gameState.money -= 1500;
                gameState.jokers++;
                showMessage('Joker purchased!', 'success');
                updateUI();
            } else {
                showMessage('Not enough money!', 'error');
            }
        }

        function useJoker() {
            if (gameState.jokers <= 0) return;
            
            gameState.jokers--;
            gameState.discardPile.push(...gameState.hand);
            gameState.hand = [];
            
            for (let i = 0; i < gameState.maxHandSize; i++) {
                drawCard();
            }
            
            showMessage('Joker used! New hand drawn!', 'success');
            updateUI();
        }

        function endTurn() {
            if (gameState.tavernDeck.length === 0) {
                showMessage('Tavern deck is empty! Game over!', 'error');
                gameLost();
                return;
            }
            showMessage('Turn ended. Draw a card.', 'success');
            drawCard();
            gameState.selectedCards = [];
            updateUI();
        }

        function selectCard(index) {
            const idx = gameState.selectedCards.indexOf(index);
            if (idx > -1) {
                gameState.selectedCards.splice(idx, 1);
            } else {
                gameState.selectedCards.push(index);
            }
            updateUI();
        }

        function showMessage(text, type = 'success') {
            const msgArea = document.getElementById('messageArea');
            msgArea.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => {
                if (msgArea.innerHTML.includes(text)) {
                    msgArea.innerHTML = '';
                }
            }, 3000);
        }

        function updateUI() {
            // Update resources
            document.getElementById('money').textContent = gameState.money;
            document.getElementById('handSize').textContent = `${gameState.hand.length}/${gameState.maxHandSize}`;
            document.getElementById('tavernCount').textContent = gameState.tavernDeck.length;

            // Update boss
            if (gameState.currentBoss) {
                const boss = gameState.currentBoss;
                document.getElementById('bossCard').innerHTML = `
                    <div class="boss-card ${boss.suit}">
                        <div>${boss.value}${SUITS[boss.suit.toUpperCase()]}</div>
                    </div>
                `;
                document.getElementById('bossStats').innerHTML = `
                    HP: ${boss.hp}/${boss.maxHp} | AP: ${boss.ap}
                `;
            } else {
                document.getElementById('bossCard').innerHTML = '<div>No boss</div>';
                document.getElementById('bossStats').innerHTML = '';
            }

            // Update hand
            const handEl = document.getElementById('hand');
            handEl.innerHTML = '';
            gameState.hand.forEach((card, idx) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `card ${card.suit}`;
                if (gameState.selectedCards.includes(idx)) {
                    cardDiv.classList.add('selected');
                }
                cardDiv.onclick = () => selectCard(idx);
                cardDiv.innerHTML = `
                    <div class="card-value">${card.value}</div>
                    <div class="card-suit">${SUITS[card.suit.toUpperCase()]}</div>
                `;
                handEl.appendChild(cardDiv);
            });

            // Update discard pile
            document.getElementById('discardPile').innerHTML = 
                gameState.discardPile.map(c => `${c.value}${SUITS[c.suit.toUpperCase()]}`).join(', ') || 'Empty';

            // Update defeated bosses
            document.getElementById('defeatedBosses').innerHTML = 
                gameState.defeatedBosses.map(b => `${b.value}${SUITS[b.suit.toUpperCase()]}`).join(', ') || 'None';

            // Update buttons based on state
            const attackBtn = document.getElementById('attackBtn');
            const skipBtn = document.getElementById('skipBtn');
            const jokerBtn = document.getElementById('jokerBtn');

            if (gameState.waitingForDiscard) {
                attackBtn.textContent = '‚úì Confirm Discard';
                attackBtn.className = 'button discard-btn';
                skipBtn.disabled = true;
                jokerBtn.disabled = true;
                
                // Check if can survive
                if (!canSurviveBossAttack(gameState.discardRequired)) {
                    gameLost();
                }
            } else {
                attackBtn.textContent = '‚öîÔ∏è Attack';
                attackBtn.className = 'button attack-btn';
                skipBtn.disabled = false;
                jokerBtn.disabled = gameState.jokers <= 0;
            }

            // Update joker button
            jokerBtn.textContent = `üÉè Use Joker (${gameState.jokers})`;
        }

        function gameWon() {
            document.body.innerHTML += `
                <div class="game-over">
                    <h2>Waw bro u won</h2>
                    <p>You have defeated all the corrupt leaders!</p>
                    <p>Final Money: ${gameState.money}</p>
                    <button class="button" onclick="location.reload()">Play Again</button>
                </div>
            `;
        }

        function gameLost() {
            document.body.innerHTML += `
                <div class="game-over">
                    <h2>Skill issue on your part!!!!!</h2>
                    <p>You ran out of cards to fight with!</p>
                    <p>Money Earned: ${gameState.money}</p>
                    <p>Bosses Defeated: ${gameState.defeatedBosses.length}/12</p>
                    <button class="button" onclick="location.reload()">Try Again</button>
                </div>
            `;
        }

        function resetGame() {
            if (confirm('Are you sure you want to start a new game?')) {
                initGame();
            }
        }

        // Initialize game on load
        initGame();
    </script>
</body>
</html>
